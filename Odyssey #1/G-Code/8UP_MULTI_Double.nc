REAL #PITCH
REAL #ROWS
REAL #ROW

REAL #XSTART (X @ FIRST ROW)
REAL #ZTOUCH (Z WHERE NOZZLE MAKE CONTACT) 

#ROW = 0
#ROWS = 5 (COUNT STARTS AT 0)

#XSTART = 45.7
(DELTA Z = 34.5
#ZTOUCH = -55.0
(#ZTOUCH = #ZTOUCH + 2.1 (ADD SUCTION CUP)
#PITCH = 42.3418 (1.667 INCHES)


WHILE #ROW <= #ROWS DO 

(################### SETUP ###################)

G59                 (SELECT 8UP TOOLING, OFFSETS)
G28 		        (SEEK HOME, REF.)
M32                 (TURN VACUUM ON)
M43		        (OPEN BLOW OFF)
G04 P0.5            (WAIT 0.5 SECONDS)
M44                 (CLOSE BLOW OFF)
M39                 (TURN FLUX ON)
M41                 (TURN N2 ON, PB-FREE)
M18 S#PUMP2RPM      (TURN SOLDER PUMP ON, PB-FREE

(################### PICKUP ###################)

G52 X0 Y0 Z0 A0 B0     (REZERO ALL)
G01 A0 F1080        (LEVEL HEAD)
G01 X[#XSTART + [#ROW*#PITCH]] F5000       (MOVE X TO PICK UP PARTS)
M28		    (TURN ON VACUUM SOLENOID, SUCTION)
G01 Z[#ZTOUCH] F500       (MOVE Z TO PICK UP PARTS)

G04 P3.5            (WAIT 3.5 SECONDS)
G01 Z-30 F500       (MOVE UP)
G01 A1 F500       (START LEVEL HEAD)
G01 A0 F500       (END LEVEL HEAD)
G91                 (SWITCH TO RELAVTIVE COORDINATES)
G01 X10
G90                 (SWITCH TO ABSOLUTE COORDINATES)

(################### FLUX #1 ###################)

G01 X693   F20000   (MOVE TO FLUX)
G01 A60     F1080        (TILT) 
G01 Z-85.0           (DIP IN FLUX) 
G91                 (SWITCH TO RELAVTIVE COORDINATES)
G01 B360 F20000     (SPIN 360 DEGREES)
G90                 (SWITCH TO ABSOLUTE COORDINATES)
G01 Z-20            (MOVE UP)
G04 P1.0	    (WAIT 1 SECOND, DRIP)
G01 A0 F500        (SET ANGLE TO 0)
(M40                 (TURN FLUX OFF)

(################### PRE-HEAT #1 ###################)

G01 X635 F20000     (MOVE TO PREHEAT)
G01 Z-55            (MOVE DOWN)
G04 P30.0           (WAIT 30 SECONDS)
G01 Z-20            (MOVE UP)
G04 P1.0            (WAIT 1 SECOND)

(################### SOLDER #1 ###################)

G01 X1873.5 F20000    (MOVE TO PB-FREE POT)
G01 A45 	F1080	(TILT 45 DEGREES)
G01 Z-32.75            (MOVE DOWN TOWARDS WAVE)
G91                 (SWITCH TO RELAVTIVE COORDINATES)

G01 Z-10  F600      (DIP INTO SOLDER)
G04 P1.0            (WAIT 1.0 SECOND)
G01 B5   F600	  (SPIN +5 DEGREES, B=5)
G01 Z5 F300         (BACK OUT OF WAVE)
G01 Z5 F20000       (BACK OUT OF WAVE)
G01 B-5 F20000      (SPIN -5 DEGREES, B=0) 

G01 B90             (SPIN TO TIN, SIDE 2)
G01 Z-10  F600      (DIP INTO SOLDER)
G04 P1.0            (WAIT 1.0 SECOND)
G01 B5   F600	  (SPIN +5 DEGREES, B=95)
G01 Z5 F300         (BACK OUT OF WAVE)
G01 Z5 F20000       (BACK OUT OF WAVE)
G01 B-5 F20000      (SPIN -5 DEGREES, B=90) 

G01 B90             (SPIN TO TIN, SIDE 3)
G01 Z-10  F600      (DIP INTO SOLDER)
G04 P1.0            (WAIT 1.0 SECOND)
G01 B5   F600	  (SPIN +5 DEGREES, B=185)
G01 Z5 F300         (BACK OUT OF WAVE)
G01 Z5 F20000       (BACK OUT OF WAVE)
G01 B-5 F20000      (SPIN -5 DEGREES, B=180) 

G01 B90             (SPIN TO TIN, SIDE 4)
G01 Z-10  F600      (DIP INTO SOLDER)
G04 P1.0            (WAIT 1.0 SECOND)
G01 B5   F600	  (SPIN +5 DEGREES, B=275)
G01 Z5 F300         (BACK OUT OF WAVE)
G01 Z5 F20000       (BACK OUT OF WAVE)
G01 B-5 F20000      (SPIN -5 DEGREES, B=270) 

G01 B90 F20000      (SPIN +90 DEGREES, B=0)

G90                 (SWITCH TO ABSOLUTE COORDINATES)
G01 Z-20            (MOVE UP)
G01 A0       F1080
(M19                 (TURN SOLDER PUMP OFF, PB-FREE)
(M42                 (TURN N2 OFF, PB-FREE)

(################### FLUX #2 ###################)

G01 X693   F20000   (MOVE TO FLUX)
G01 A60     F1080        (TILT) 
G01 Z-85.0           (DIP IN FLUX) 
G91                 (SWITCH TO RELAVTIVE COORDINATES)
G01 B360 F20000     (SPIN 360 DEGREES)
G90                 (SWITCH TO ABSOLUTE COORDINATES)
G01 Z-20            (MOVE UP)
G04 P1.0	    (WAIT 1 SECOND, DRIP)
G01 A0 F500        (SET ANGLE TO 0)

(################### PRE-HEAT #2 ###################)

G01 X635 F20000     (MOVE TO PREHEAT)
G01 Z-55            (MOVE DOWN)
G04 P10.0           (WAIT 30 SECONDS)
G01 Z-20            (MOVE UP)
G04 P1.0            (WAIT 1 SECOND)

(################### SOLDER #2 ###################)

G01 X1873.5 F20000    (MOVE TO PB-FREE POT)
G01 A45 	F1080	(TILT 45 DEGREES)
G01 Z-32.75            (MOVE DOWN TOWARDS WAVE)
G91                 (SWITCH TO RELAVTIVE COORDINATES)

G01 Z-10  F600      (DIP INTO SOLDER)
G04 P1.0            (WAIT 1.0 SECOND)
G01 B5   F600	  (SPIN +5 DEGREES, B=5)
G01 Z5 F300         (BACK OUT OF WAVE)
G01 Z5 F20000       (BACK OUT OF WAVE)
G01 B-5 F20000      (SPIN -5 DEGREES, B=0) 

G01 B90             (SPIN TO TIN, SIDE 2)
G01 Z-10  F600      (DIP INTO SOLDER)
G04 P1.0            (WAIT 1.0 SECOND)
G01 B5   F600	  (SPIN +5 DEGREES, B=95)
G01 Z5 F300         (BACK OUT OF WAVE)
G01 Z5 F20000       (BACK OUT OF WAVE)
G01 B-5 F20000      (SPIN -5 DEGREES, B=90) 

G01 B90             (SPIN TO TIN, SIDE 3)
G01 Z-10  F600      (DIP INTO SOLDER)
G04 P1.0            (WAIT 1.0 SECOND)
G01 B5   F600	  (SPIN +5 DEGREES, B=185)
G01 Z5 F300         (BACK OUT OF WAVE)
G01 Z5 F20000       (BACK OUT OF WAVE)
G01 B-5 F20000      (SPIN -5 DEGREES, B=180) 

G01 B90             (SPIN TO TIN, SIDE 4)
G01 Z-10  F600      (DIP INTO SOLDER)
G04 P1.0            (WAIT 1.0 SECOND)
G01 B5   F600	  (SPIN +5 DEGREES, B=275)
G01 Z5 F300         (BACK OUT OF WAVE)
G01 Z5 F20000       (BACK OUT OF WAVE)
G01 B-5 F20000      (SPIN -5 DEGREES, B=270) 

G01 B90 F20000      (SPIN +90 DEGREES, B=0)

G90                 (SWITCH TO ABSOLUTE COORDINATES)
G01 Z-20            (MOVE UP)
G01 A0       F1080
M19                 (TURN SOLDER PUMP OFF, PB-FREE)
M42                 (TURN N2 OFF, PB-FREE)


(###################### RINSE ######################)
M26                 (TURN RINSE ON)
G01 X422  F20000    (MOVE TO RINSE)
G01 Z-58.5          (MOVE DOWN)
G91                 (SWITCH TO RELAVTIVE COORDINATES)
G01 B360 F2000      (SPIN IN RINSE)
G90                 (SWITCH TO ABSOLUTE COORDINATES)
G01 Z-20            (MOVE UP)
G91                 (SWITCH TO RELAVTIVE COORDINATES)
G01 X-115 F20000
G01 A45             (TILT TO DRIP)
G01 B315 F2000      (SPIN 315 DEGREES)
G01 A5 F2000             (SHAKE)
G01 A-5 F2000             (SHAKE)
G01 A10 F2000             (SHAKE)
G01 A-10 F2000             (SHAKE)
G04 P2.5            (WAIT 2.5 SECONDS)
G01 A5 F2000             (SHAKE)
G01 A-5 F2000             (SHAKE)
G01 B45 F2000      (SPIN 45 DEGREES)
G01 X230 F20000
G01 A-90            (TILT TO DRIP)
G01 B315 F2000      (SPIN IN RINSE)
G01 A5 F2000             (SHAKE)
G01 A-5 F2000             (SHAKE)
G01 A10 F2000             (SHAKE)
G01 A-10 F2000             (SHAKE)
G04 P2.5            (WAIT 2.5 SECONDS)
G01 A5 F2000             (SHAKE)
G01 A-5 F2000             (SHAKE)
G01 B45 F2000      (SPIN 45 DEGREES)
G90                 (SWITCH TO ABSOLUTE COORDINATES)
G01 A0   F1080      (LEVEL HEAD, A=0)
M27                 (TURN RINSE OFF)

(################### HEAT DRY ###################)

G01 X623 F20000     (MOVE TO PREHEAT)
G01 Z-52            (MOVE DOWN)
G04 P5.0           (WAIT 30 SECONDS)
G01 Z-20            (MOVE UP)
G04 P1.0            (WAIT 1 SECOND)


(################### RETURN PARTS ###################)

G01 X[#XSTART + [#ROW*#PITCH]+50]  F20000
G01 X[#XSTART + [#ROW*#PITCH]]  F500
G04 P0.5            (WAIT 0.5 SECONDS)
G01 Z[#ZTOUCH + 0.5] F500       (PUT PARTS DOWN)
M33                 (TURN VACUUM OFF)
M29		        (TURN OFF VACUUM SOLENOID, SUCTION)
M43                 (OPEN TO ATMOSPHERE)
M44                 (CLOSE TO ATMOSPHERE)
M24                 (TURN ON AIR KNIFE)
G04 P0.5            (WAIT 0.5 SECONDS)
G01 Z[#ZTOUCH + 2.5] F500       (MOVE UP)
G04 P5.5            (WAIT 5.5 SECONDS)
G01 Z[#ZTOUCH + 1.5] F500       (MOVE UP)
G04 P2.5            (WAIT 2.5 SECONDS)
G01 Z-50 F2000      (MOVE UP)
M25                 (TURN OFF AIR KNIFE)		
M43                 (OPEN TO ATMOSPHERE)
#ROW = #ROW +1
ENDWHILE
G28 		        (SEEK HOME, REF.)
M40                 (TURN FLUX OFF)